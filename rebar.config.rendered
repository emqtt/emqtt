{minimum_otp_vsn,"21.3"}.
{edoc_opts,[{preprocess,true}]}.
{erl_opts,[warn_unused_vars,warn_shadow_vars,warn_unused_import,
           warn_obsolete_guard,compressed]}.
{overrides,[{add,[{erl_opts,[compressed,deterministic]}]},
            {add,[{extra_src_dirs,[{"etc",[{recursive,true}]}]}]}]}.
{extra_src_dirs,[{"etc",[{recursive,true}]}]}.
{xref_checks,[undefined_function_calls,undefined_functions,locals_not_used,
              deprecated_function_calls,warnings_as_errors,
              deprecated_functions]}.
{dialyzer,[{warnings,[unmatched_returns,error_handling,race_conditions]},
           {plt_location,"."},
           {plt_prefix,"emqx_dialyzer"},
           {plt_apps,all_apps},
           {statistics,true}]}.
{cover_enabled,true}.
{cover_opts,[verbose]}.
{cover_export_enabled,true}.
{cover_excl_mods,[emqx_exproto_pb,emqx_exhook_pb]}.
{provider_hooks,[{pre,[{release,{relup_helper,gen_appups}}]}]}.
{post_hooks,[]}.
{erl_first_files,["src/emqx_logger.erl"]}.
{deps,[{gproc,{git,"https://github.com/uwiger/gproc",{tag,"0.8.0"}}},
       {jiffy,{git,"https://github.com/emqx/jiffy",{tag,"1.0.5"}}},
       {cowboy,{git,"https://github.com/emqx/cowboy",{tag,"2.7.1"}}},
       {esockd,{git,"https://github.com/emqx/esockd",{tag,"5.8.0"}}},
       {ekka,{git,"https://github.com/emqx/ekka",{tag,"0.8.0"}}},
       {gen_rpc,{git,"https://github.com/emqx/gen_rpc",{tag,"2.5.0"}}},
       {cuttlefish,{git,"https://github.com/emqx/cuttlefish",{tag,"v3.0.0"}}},
       {minirest,{git,"https://github.com/emqx/minirest",{tag,"0.3.3"}}},
       {ecpool,{git,"https://github.com/emqx/ecpool",{tag,"0.5.0"}}},
       {replayq,{git,"https://github.com/emqx/replayq",{tag,"0.3.1"}}},
       {pbkdf2,{git,"https://github.com/emqx/erlang-pbkdf2.git",
                    {branch,"2.0.4"}}},
       {emqtt,{git,"https://github.com/emqx/emqtt",{tag,"1.2.3"}}},
       {rulesql,{git,"https://github.com/emqx/rulesql",{tag,"0.1.2"}}},
       {recon,{git,"https://github.com/ferd/recon",{tag,"2.5.1"}}},
       {getopt,"1.0.1"},
       {bcrypt,{git,"https://github.com/emqx/erlang-bcrypt.git",
                    {branch,"0.6.0"}}}]}.
{xref_ignores,[{emqx_schema_registry,get_all_schemas,0},
               {emqx_schema_api,format_schema,1},
               {emqx_schema_api,make_schema_params,1},
               {emqx_schema_parser,decode,3},
               {emqx_schema_parser,encode,3},
               {emqx_schema_registry,add_schema,1},
               emqx_exhook_pb,emqx_exproto_pb]}.
{minimum_otp_vsn,"21.3"}.
{edoc_opts,[{preprocess,true}]}.
{erl_opts,[warn_unused_vars,warn_shadow_vars,warn_unused_import,
           warn_obsolete_guard,compressed]}.
{overrides,[{add,[{erl_opts,[compressed,deterministic]}]},
            {add,[{extra_src_dirs,[{"etc",[{recursive,true}]}]}]}]}.
{extra_src_dirs,[{"etc",[{recursive,true}]}]}.
{xref_checks,[undefined_function_calls,undefined_functions,locals_not_used,
              deprecated_function_calls,warnings_as_errors,
              deprecated_functions]}.
{dialyzer,[{warnings,[unmatched_returns,error_handling,race_conditions]},
           {plt_location,"."},
           {plt_prefix,"emqx_dialyzer"},
           {plt_apps,all_apps},
           {statistics,true}]}.
{cover_enabled,true}.
{cover_opts,[verbose]}.
{cover_export_enabled,true}.
{cover_excl_mods,[emqx_exproto_pb,emqx_exhook_pb]}.
{provider_hooks,[{pre,[{release,{relup_helper,gen_appups}}]}]}.
{post_hooks,[]}.
{erl_first_files,["src/emqx_logger.erl"]}.
{deps,[{gproc,{git,"https://github.com/uwiger/gproc",{tag,"0.8.0"}}},
       {jiffy,{git,"https://github.com/emqx/jiffy",{tag,"1.0.5"}}},
       {cowboy,{git,"https://github.com/emqx/cowboy",{tag,"2.7.1"}}},
       {esockd,{git,"https://github.com/emqx/esockd",{tag,"5.8.0"}}},
       {ekka,{git,"https://github.com/emqx/ekka",{tag,"0.8.0"}}},
       {gen_rpc,{git,"https://github.com/emqx/gen_rpc",{tag,"2.5.0"}}},
       {cuttlefish,{git,"https://github.com/emqx/cuttlefish",{tag,"v3.0.0"}}},
       {minirest,{git,"https://github.com/emqx/minirest",{tag,"0.3.3"}}},
       {ecpool,{git,"https://github.com/emqx/ecpool",{tag,"0.5.0"}}},
       {replayq,{git,"https://github.com/emqx/replayq",{tag,"0.3.1"}}},
       {pbkdf2,{git,"https://github.com/emqx/erlang-pbkdf2.git",
                    {branch,"2.0.4"}}},
       {emqtt,{git,"https://github.com/emqx/emqtt",{tag,"1.2.3"}}},
       {rulesql,{git,"https://github.com/emqx/rulesql",{tag,"0.1.2"}}},
       {recon,{git,"https://github.com/ferd/recon",{tag,"2.5.1"}}},
       {getopt,"1.0.1"}]}.
{xref_ignores,[{emqx_schema_registry,get_all_schemas,0},
               {emqx_schema_api,format_schema,1},
               {emqx_schema_api,make_schema_params,1},
               {emqx_schema_parser,decode,3},
               {emqx_schema_parser,encode,3},
               {emqx_schema_registry,add_schema,1},
               emqx_exhook_pb,emqx_exproto_pb]}.
{plugins,[{relup_helper,{git,"https://github.com/emqx/relup_helper",
                             {branch,"master"}}},
          {er_coap_client,{git,"https://github.com/emqx/er_coap_client",
                               {tag,"v1.0"}}}]}.
{profiles,
    [{emqx,
         [{erl_opts,
              [no_debug_info,warnings_as_errors,{parse_transform,mod_vsn}]},
          {relx,
              [{include_src,false},
               {include_erts,true},
               {extended_start_script,false},
               {generate_start_script,false},
               {sys_config,false},
               {vm_args,false},
               {release,
                   {emqx,"4.3-alpha.1"},
                   [kernel,sasl,crypto,public_key,asn1,syntax_tools,ssl,
                    os_mon,inets,compiler,runtime_tools,cuttlefish,emqx,
                    {mnesia,load},
                    {ekka,load},
                    bcrypt,
                    {observer,load},
                    luerl,xmerl,
                    {emqx_retainer,load},
                    {emqx_management,load},
                    {emqx_dashboard,load},
                    {emqx_bridge_mqtt,load},
                    {emqx_sn,load},
                    {emqx_coap,load},
                    {emqx_stomp,load},
                    {emqx_auth_http,load},
                    {emqx_auth_mysql,load},
                    {emqx_auth_jwt,load},
                    {emqx_auth_mnesia,load},
                    {emqx_web_hook,load},
                    {emqx_recon,load},
                    {emqx_rule_engine,load},
                    {emqx_sasl,load},
                    {emqx_telemetry,load},
                    {emqx_lwm2m,load},
                    {emqx_auth_ldap,load},
                    {emqx_auth_pgsql,load},
                    {emqx_auth_redis,load},
                    {emqx_auth_mongo,load},
                    {emqx_lua_hook,load},
                    {emqx_exhook,load},
                    {emqx_exproto,load},
                    {emqx_prometheus,load},
                    {emqx_psk_file,load},
                    {emqx_plugin_template,load}]},
               {overlay,
                   [{mkdir,"log/"},
                    {mkdir,"data/"},
                    {mkdir,"data/mnesia"},
                    {mkdir,"data/configs"},
                    {mkdir,"data/scripts"},
                    {template,"data/loaded_plugins.tmpl",
                        "data/loaded_plugins"},
                    {template,"data/loaded_modules.tmpl",
                        "data/loaded_modules"},
                    {template,"data/emqx_vars","releases/emqx_vars"},
                    {copy,"bin/emqx","bin/emqx"},
                    {copy,"bin/emqx_ctl","bin/emqx_ctl"},
                    {copy,"bin/install_upgrade.escript",
                        "bin/install_upgrade.escript"},
                    {copy,"bin/emqx","bin/emqx-{{release_version}}"},
                    {copy,"bin/emqx_ctl","bin/emqx_ctl-{{release_version}}"},
                    {copy,"bin/install_upgrade.escript",
                        "bin/install_upgrade.escript-{{release_version}}"},
                    {template,"bin/emqx.cmd","bin/emqx.cmd"},
                    {template,"bin/emqx_ctl.cmd","bin/emqx_ctl.cmd"},
                    {copy,"bin/nodetool","bin/nodetool"},
                    {copy,"bin/nodetool","bin/nodetool-{{release_version}}"},
                    {copy,"_build/default/lib/cuttlefish/cuttlefish",
                        "bin/cuttlefish"},
                    {copy,"_build/default/lib/cuttlefish/cuttlefish",
                        "bin/cuttlefish-{{release_version}}"},
                    {copy,"priv/emqx.schema","releases/{{release_version}}/"},
                    {mkdir,"etc/"},
                    {mkdir,"etc/plugins"},
                    {template,"etc/BUILT_ON",
                        "releases/{{release_version}}/BUILT_ON"},
                    {copy,"{{base_dir}}/lib/emqx/etc/certs","etc/"},
                    {template,"etc/acl.conf","etc/acl.conf"},
                    {template,"etc/emqx.conf","etc/emqx.conf"},
                    {template,"etc/ssl_dist.conf","etc/ssl_dist.conf"},
                    {template,"etc/acl.conf.paho","etc/plugins/acl.conf.paho"},
                    {template,"etc/emqx_cloud.d/vm.args","etc/vm.args"},
                    {template,
                        "{{base_dir}}/lib/emqx_retainer/etc/emqx_retainer.conf",
                        "etc/plugins/emqx_retainer.conf"},
                    {template,
                        "{{base_dir}}/lib/emqx_management/etc/emqx_management.conf",
                        "etc/plugins/emqx_management.conf"},
                    {template,
                        "{{base_dir}}/lib/emqx_dashboard/etc/emqx_dashboard.conf",
                        "etc/plugins/emqx_dashboard.conf"},
                    {template,
                        "{{base_dir}}/lib/emqx_bridge_mqtt/etc/emqx_bridge_mqtt.conf",
                        "etc/plugins/emqx_bridge_mqtt.conf"},
                    {template,"{{base_dir}}/lib/emqx_sn/etc/emqx_sn.conf",
                        "etc/plugins/emqx_sn.conf"},
                    {template,
                        "{{base_dir}}/lib/emqx_coap/etc/emqx_coap.conf",
                        "etc/plugins/emqx_coap.conf"},
                    {template,
                        "{{base_dir}}/lib/emqx_stomp/etc/emqx_stomp.conf",
                        "etc/plugins/emqx_stomp.conf"},
                    {template,
                        "{{base_dir}}/lib/emqx_auth_http/etc/emqx_auth_http.conf",
                        "etc/plugins/emqx_auth_http.conf"},
                    {template,
                        "{{base_dir}}/lib/emqx_auth_mysql/etc/emqx_auth_mysql.conf",
                        "etc/plugins/emqx_auth_mysql.conf"},
                    {template,
                        "{{base_dir}}/lib/emqx_auth_jwt/etc/emqx_auth_jwt.conf",
                        "etc/plugins/emqx_auth_jwt.conf"},
                    {template,
                        "{{base_dir}}/lib/emqx_auth_mnesia/etc/emqx_auth_mnesia.conf",
                        "etc/plugins/emqx_auth_mnesia.conf"},
                    {template,
                        "{{base_dir}}/lib/emqx_web_hook/etc/emqx_web_hook.conf",
                        "etc/plugins/emqx_web_hook.conf"},
                    {template,
                        "{{base_dir}}/lib/emqx_recon/etc/emqx_recon.conf",
                        "etc/plugins/emqx_recon.conf"},
                    {template,
                        "{{base_dir}}/lib/emqx_rule_engine/etc/emqx_rule_engine.conf",
                        "etc/plugins/emqx_rule_engine.conf"},
                    {template,
                        "{{base_dir}}/lib/emqx_sasl/etc/emqx_sasl.conf",
                        "etc/plugins/emqx_sasl.conf"},
                    {template,
                        "{{base_dir}}/lib/emqx_telemetry/etc/emqx_telemetry.conf",
                        "etc/plugins/emqx_telemetry.conf"},
                    {template,
                        "{{base_dir}}/lib/emqx_lwm2m/etc/emqx_lwm2m.conf",
                        "etc/plugins/emqx_lwm2m.conf"},
                    {template,
                        "{{base_dir}}/lib/emqx_auth_ldap/etc/emqx_auth_ldap.conf",
                        "etc/plugins/emqx_auth_ldap.conf"},
                    {template,
                        "{{base_dir}}/lib/emqx_auth_pgsql/etc/emqx_auth_pgsql.conf",
                        "etc/plugins/emqx_auth_pgsql.conf"},
                    {template,
                        "{{base_dir}}/lib/emqx_auth_redis/etc/emqx_auth_redis.conf",
                        "etc/plugins/emqx_auth_redis.conf"},
                    {template,
                        "{{base_dir}}/lib/emqx_auth_mongo/etc/emqx_auth_mongo.conf",
                        "etc/plugins/emqx_auth_mongo.conf"},
                    {template,
                        "{{base_dir}}/lib/emqx_lua_hook/etc/emqx_lua_hook.conf",
                        "etc/plugins/emqx_lua_hook.conf"},
                    {template,
                        "{{base_dir}}/lib/emqx_exhook/etc/emqx_exhook.conf",
                        "etc/plugins/emqx_exhook.conf"},
                    {template,
                        "{{base_dir}}/lib/emqx_exproto/etc/emqx_exproto.conf",
                        "etc/plugins/emqx_exproto.conf"},
                    {template,
                        "{{base_dir}}/lib/emqx_prometheus/etc/emqx_prometheus.conf",
                        "etc/plugins/emqx_prometheus.conf"},
                    {template,
                        "{{base_dir}}/lib/emqx_psk_file/etc/emqx_psk_file.conf",
                        "etc/plugins/emqx_psk_file.conf"},
                    {copy,"{{base_dir}}/lib/emqx_lwm2m/lwm2m_xml","etc/"},
                    {copy,"{{base_dir}}/lib/emqx_psk_file/etc/psk.txt",
                        "etc/psk.txt"}]},
               {overlay_vars,
                   [{built_on_arch,"22.3.4.12-x86_64-apple-darwin19.6.0-64"},
                    "vars/vars-cloud.config","vars/vars-bin.config"]}]}]},
     {'emqx-pkg',
         [{erl_opts,
              [no_debug_info,warnings_as_errors,{parse_transform,mod_vsn}]},
          {relx,
              [{include_src,false},
               {include_erts,true},
               {extended_start_script,false},
               {generate_start_script,false},
               {sys_config,false},
               {vm_args,false},
               {release,
                   {emqx,"4.3-alpha.1"},
                   [kernel,sasl,crypto,public_key,asn1,syntax_tools,ssl,
                    os_mon,inets,compiler,runtime_tools,cuttlefish,emqx,
                    {mnesia,load},
                    {ekka,load},
                    bcrypt,
                    {observer,load},
                    luerl,xmerl,
                    {emqx_retainer,load},
                    {emqx_management,load},
                    {emqx_dashboard,load},
                    {emqx_bridge_mqtt,load},
                    {emqx_sn,load},
                    {emqx_coap,load},
                    {emqx_stomp,load},
                    {emqx_auth_http,load},
                    {emqx_auth_mysql,load},
                    {emqx_auth_jwt,load},
                    {emqx_auth_mnesia,load},
                    {emqx_web_hook,load},
                    {emqx_recon,load},
                    {emqx_rule_engine,load},
                    {emqx_sasl,load},
                    {emqx_telemetry,load},
                    {emqx_lwm2m,load},
                    {emqx_auth_ldap,load},
                    {emqx_auth_pgsql,load},
                    {emqx_auth_redis,load},
                    {emqx_auth_mongo,load},
                    {emqx_lua_hook,load},
                    {emqx_exhook,load},
                    {emqx_exproto,load},
                    {emqx_prometheus,load},
                    {emqx_psk_file,load},
                    {emqx_plugin_template,load}]},
               {overlay,
                   [{mkdir,"log/"},
                    {mkdir,"data/"},
                    {mkdir,"data/mnesia"},
                    {mkdir,"data/configs"},
                    {mkdir,"data/scripts"},
                    {template,"data/loaded_plugins.tmpl",
                        "data/loaded_plugins"},
                    {template,"data/loaded_modules.tmpl",
                        "data/loaded_modules"},
                    {template,"data/emqx_vars","releases/emqx_vars"},
                    {copy,"bin/emqx","bin/emqx"},
                    {copy,"bin/emqx_ctl","bin/emqx_ctl"},
                    {copy,"bin/install_upgrade.escript",
                        "bin/install_upgrade.escript"},
                    {copy,"bin/emqx","bin/emqx-{{release_version}}"},
                    {copy,"bin/emqx_ctl","bin/emqx_ctl-{{release_version}}"},
                    {copy,"bin/install_upgrade.escript",
                        "bin/install_upgrade.escript-{{release_version}}"},
                    {template,"bin/emqx.cmd","bin/emqx.cmd"},
                    {template,"bin/emqx_ctl.cmd","bin/emqx_ctl.cmd"},
                    {copy,"bin/nodetool","bin/nodetool"},
                    {copy,"bin/nodetool","bin/nodetool-{{release_version}}"},
                    {copy,"_build/default/lib/cuttlefish/cuttlefish",
                        "bin/cuttlefish"},
                    {copy,"_build/default/lib/cuttlefish/cuttlefish",
                        "bin/cuttlefish-{{release_version}}"},
                    {copy,"priv/emqx.schema","releases/{{release_version}}/"},
                    {mkdir,"etc/"},
                    {mkdir,"etc/plugins"},
                    {template,"etc/BUILT_ON",
                        "releases/{{release_version}}/BUILT_ON"},
                    {copy,"{{base_dir}}/lib/emqx/etc/certs","etc/"},
                    {template,"etc/acl.conf","etc/acl.conf"},
                    {template,"etc/emqx.conf","etc/emqx.conf"},
                    {template,"etc/ssl_dist.conf","etc/ssl_dist.conf"},
                    {template,"etc/acl.conf.paho","etc/plugins/acl.conf.paho"},
                    {template,"etc/emqx_cloud.d/vm.args","etc/vm.args"},
                    {template,
                        "{{base_dir}}/lib/emqx_retainer/etc/emqx_retainer.conf",
                        "etc/plugins/emqx_retainer.conf"},
                    {template,
                        "{{base_dir}}/lib/emqx_management/etc/emqx_management.conf",
                        "etc/plugins/emqx_management.conf"},
                    {template,
                        "{{base_dir}}/lib/emqx_dashboard/etc/emqx_dashboard.conf",
                        "etc/plugins/emqx_dashboard.conf"},
                    {template,
                        "{{base_dir}}/lib/emqx_bridge_mqtt/etc/emqx_bridge_mqtt.conf",
                        "etc/plugins/emqx_bridge_mqtt.conf"},
                    {template,"{{base_dir}}/lib/emqx_sn/etc/emqx_sn.conf",
                        "etc/plugins/emqx_sn.conf"},
                    {template,
                        "{{base_dir}}/lib/emqx_coap/etc/emqx_coap.conf",
                        "etc/plugins/emqx_coap.conf"},
                    {template,
                        "{{base_dir}}/lib/emqx_stomp/etc/emqx_stomp.conf",
                        "etc/plugins/emqx_stomp.conf"},
                    {template,
                        "{{base_dir}}/lib/emqx_auth_http/etc/emqx_auth_http.conf",
                        "etc/plugins/emqx_auth_http.conf"},
                    {template,
                        "{{base_dir}}/lib/emqx_auth_mysql/etc/emqx_auth_mysql.conf",
                        "etc/plugins/emqx_auth_mysql.conf"},
                    {template,
                        "{{base_dir}}/lib/emqx_auth_jwt/etc/emqx_auth_jwt.conf",
                        "etc/plugins/emqx_auth_jwt.conf"},
                    {template,
                        "{{base_dir}}/lib/emqx_auth_mnesia/etc/emqx_auth_mnesia.conf",
                        "etc/plugins/emqx_auth_mnesia.conf"},
                    {template,
                        "{{base_dir}}/lib/emqx_web_hook/etc/emqx_web_hook.conf",
                        "etc/plugins/emqx_web_hook.conf"},
                    {template,
                        "{{base_dir}}/lib/emqx_recon/etc/emqx_recon.conf",
                        "etc/plugins/emqx_recon.conf"},
                    {template,
                        "{{base_dir}}/lib/emqx_rule_engine/etc/emqx_rule_engine.conf",
                        "etc/plugins/emqx_rule_engine.conf"},
                    {template,
                        "{{base_dir}}/lib/emqx_sasl/etc/emqx_sasl.conf",
                        "etc/plugins/emqx_sasl.conf"},
                    {template,
                        "{{base_dir}}/lib/emqx_telemetry/etc/emqx_telemetry.conf",
                        "etc/plugins/emqx_telemetry.conf"},
                    {template,
                        "{{base_dir}}/lib/emqx_lwm2m/etc/emqx_lwm2m.conf",
                        "etc/plugins/emqx_lwm2m.conf"},
                    {template,
                        "{{base_dir}}/lib/emqx_auth_ldap/etc/emqx_auth_ldap.conf",
                        "etc/plugins/emqx_auth_ldap.conf"},
                    {template,
                        "{{base_dir}}/lib/emqx_auth_pgsql/etc/emqx_auth_pgsql.conf",
                        "etc/plugins/emqx_auth_pgsql.conf"},
                    {template,
                        "{{base_dir}}/lib/emqx_auth_redis/etc/emqx_auth_redis.conf",
                        "etc/plugins/emqx_auth_redis.conf"},
                    {template,
                        "{{base_dir}}/lib/emqx_auth_mongo/etc/emqx_auth_mongo.conf",
                        "etc/plugins/emqx_auth_mongo.conf"},
                    {template,
                        "{{base_dir}}/lib/emqx_lua_hook/etc/emqx_lua_hook.conf",
                        "etc/plugins/emqx_lua_hook.conf"},
                    {template,
                        "{{base_dir}}/lib/emqx_exhook/etc/emqx_exhook.conf",
                        "etc/plugins/emqx_exhook.conf"},
                    {template,
                        "{{base_dir}}/lib/emqx_exproto/etc/emqx_exproto.conf",
                        "etc/plugins/emqx_exproto.conf"},
                    {template,
                        "{{base_dir}}/lib/emqx_prometheus/etc/emqx_prometheus.conf",
                        "etc/plugins/emqx_prometheus.conf"},
                    {template,
                        "{{base_dir}}/lib/emqx_psk_file/etc/emqx_psk_file.conf",
                        "etc/plugins/emqx_psk_file.conf"},
                    {copy,"{{base_dir}}/lib/emqx_lwm2m/lwm2m_xml","etc/"},
                    {copy,"{{base_dir}}/lib/emqx_psk_file/etc/psk.txt",
                        "etc/psk.txt"}]},
               {overlay_vars,
                   [{built_on_arch,"22.3.4.12-x86_64-apple-darwin19.6.0-64"},
                    "vars/vars-cloud.config","vars/vars-pkg.config"]}]}]},
     {'emqx-edge',
         [{erl_opts,
              [no_debug_info,warnings_as_errors,{parse_transform,mod_vsn}]},
          {relx,
              [{include_src,false},
               {include_erts,true},
               {extended_start_script,false},
               {generate_start_script,false},
               {sys_config,false},
               {vm_args,false},
               {release,
                   {emqx,"4.3-alpha.1"},
                   [kernel,sasl,crypto,public_key,asn1,syntax_tools,ssl,
                    os_mon,inets,compiler,runtime_tools,cuttlefish,emqx,
                    {mnesia,load},
                    {ekka,load},
                    {emqx_retainer,load},
                    {emqx_management,load},
                    {emqx_dashboard,load},
                    {emqx_bridge_mqtt,load},
                    {emqx_sn,load},
                    {emqx_coap,load},
                    {emqx_stomp,load},
                    {emqx_auth_http,load},
                    {emqx_auth_mysql,load},
                    {emqx_auth_jwt,load},
                    {emqx_auth_mnesia,load},
                    {emqx_web_hook,load},
                    {emqx_recon,load},
                    {emqx_rule_engine,load},
                    {emqx_sasl,load},
                    {emqx_telemetry,load}]},
               {overlay,
                   [{mkdir,"log/"},
                    {mkdir,"data/"},
                    {mkdir,"data/mnesia"},
                    {mkdir,"data/configs"},
                    {mkdir,"data/scripts"},
                    {template,"data/loaded_plugins.tmpl",
                        "data/loaded_plugins"},
                    {template,"data/loaded_modules.tmpl",
                        "data/loaded_modules"},
                    {template,"data/emqx_vars","releases/emqx_vars"},
                    {copy,"bin/emqx","bin/emqx"},
                    {copy,"bin/emqx_ctl","bin/emqx_ctl"},
                    {copy,"bin/install_upgrade.escript",
                        "bin/install_upgrade.escript"},
                    {copy,"bin/emqx","bin/emqx-{{release_version}}"},
                    {copy,"bin/emqx_ctl","bin/emqx_ctl-{{release_version}}"},
                    {copy,"bin/install_upgrade.escript",
                        "bin/install_upgrade.escript-{{release_version}}"},
                    {template,"bin/emqx.cmd","bin/emqx.cmd"},
                    {template,"bin/emqx_ctl.cmd","bin/emqx_ctl.cmd"},
                    {copy,"bin/nodetool","bin/nodetool"},
                    {copy,"bin/nodetool","bin/nodetool-{{release_version}}"},
                    {copy,"_build/default/lib/cuttlefish/cuttlefish",
                        "bin/cuttlefish"},
                    {copy,"_build/default/lib/cuttlefish/cuttlefish",
                        "bin/cuttlefish-{{release_version}}"},
                    {copy,"priv/emqx.schema","releases/{{release_version}}/"},
                    {mkdir,"etc/"},
                    {mkdir,"etc/plugins"},
                    {template,"etc/BUILT_ON",
                        "releases/{{release_version}}/BUILT_ON"},
                    {copy,"{{base_dir}}/lib/emqx/etc/certs","etc/"},
                    {template,"etc/acl.conf","etc/acl.conf"},
                    {template,"etc/emqx.conf","etc/emqx.conf"},
                    {template,"etc/ssl_dist.conf","etc/ssl_dist.conf"},
                    {template,"etc/acl.conf.paho","etc/plugins/acl.conf.paho"},
                    {template,"etc/emqx_edge.d/vm.args","etc/vm.args"},
                    {template,
                        "{{base_dir}}/lib/emqx_retainer/etc/emqx_retainer.conf",
                        "etc/plugins/emqx_retainer.conf"},
                    {template,
                        "{{base_dir}}/lib/emqx_management/etc/emqx_management.conf",
                        "etc/plugins/emqx_management.conf"},
                    {template,
                        "{{base_dir}}/lib/emqx_dashboard/etc/emqx_dashboard.conf",
                        "etc/plugins/emqx_dashboard.conf"},
                    {template,
                        "{{base_dir}}/lib/emqx_bridge_mqtt/etc/emqx_bridge_mqtt.conf",
                        "etc/plugins/emqx_bridge_mqtt.conf"},
                    {template,"{{base_dir}}/lib/emqx_sn/etc/emqx_sn.conf",
                        "etc/plugins/emqx_sn.conf"},
                    {template,
                        "{{base_dir}}/lib/emqx_coap/etc/emqx_coap.conf",
                        "etc/plugins/emqx_coap.conf"},
                    {template,
                        "{{base_dir}}/lib/emqx_stomp/etc/emqx_stomp.conf",
                        "etc/plugins/emqx_stomp.conf"},
                    {template,
                        "{{base_dir}}/lib/emqx_auth_http/etc/emqx_auth_http.conf",
                        "etc/plugins/emqx_auth_http.conf"},
                    {template,
                        "{{base_dir}}/lib/emqx_auth_mysql/etc/emqx_auth_mysql.conf",
                        "etc/plugins/emqx_auth_mysql.conf"},
                    {template,
                        "{{base_dir}}/lib/emqx_auth_jwt/etc/emqx_auth_jwt.conf",
                        "etc/plugins/emqx_auth_jwt.conf"},
                    {template,
                        "{{base_dir}}/lib/emqx_auth_mnesia/etc/emqx_auth_mnesia.conf",
                        "etc/plugins/emqx_auth_mnesia.conf"},
                    {template,
                        "{{base_dir}}/lib/emqx_web_hook/etc/emqx_web_hook.conf",
                        "etc/plugins/emqx_web_hook.conf"},
                    {template,
                        "{{base_dir}}/lib/emqx_recon/etc/emqx_recon.conf",
                        "etc/plugins/emqx_recon.conf"},
                    {template,
                        "{{base_dir}}/lib/emqx_rule_engine/etc/emqx_rule_engine.conf",
                        "etc/plugins/emqx_rule_engine.conf"},
                    {template,
                        "{{base_dir}}/lib/emqx_sasl/etc/emqx_sasl.conf",
                        "etc/plugins/emqx_sasl.conf"},
                    {template,
                        "{{base_dir}}/lib/emqx_telemetry/etc/emqx_telemetry.conf",
                        "etc/plugins/emqx_telemetry.conf"}]},
               {overlay_vars,
                   [{built_on_arch,"22.3.4.12-x86_64-apple-darwin19.6.0-64"},
                    "vars/vars-edge.config","vars/vars-bin.config"]}]}]},
     {'emqx-edge-pkg',
         [{erl_opts,
              [no_debug_info,warnings_as_errors,{parse_transform,mod_vsn}]},
          {relx,
              [{include_src,false},
               {include_erts,true},
               {extended_start_script,false},
               {generate_start_script,false},
               {sys_config,false},
               {vm_args,false},
               {release,
                   {emqx,"4.3-alpha.1"},
                   [kernel,sasl,crypto,public_key,asn1,syntax_tools,ssl,
                    os_mon,inets,compiler,runtime_tools,cuttlefish,emqx,
                    {mnesia,load},
                    {ekka,load},
                    {emqx_retainer,load},
                    {emqx_management,load},
                    {emqx_dashboard,load},
                    {emqx_bridge_mqtt,load},
                    {emqx_sn,load},
                    {emqx_coap,load},
                    {emqx_stomp,load},
                    {emqx_auth_http,load},
                    {emqx_auth_mysql,load},
                    {emqx_auth_jwt,load},
                    {emqx_auth_mnesia,load},
                    {emqx_web_hook,load},
                    {emqx_recon,load},
                    {emqx_rule_engine,load},
                    {emqx_sasl,load},
                    {emqx_telemetry,load}]},
               {overlay,
                   [{mkdir,"log/"},
                    {mkdir,"data/"},
                    {mkdir,"data/mnesia"},
                    {mkdir,"data/configs"},
                    {mkdir,"data/scripts"},
                    {template,"data/loaded_plugins.tmpl",
                        "data/loaded_plugins"},
                    {template,"data/loaded_modules.tmpl",
                        "data/loaded_modules"},
                    {template,"data/emqx_vars","releases/emqx_vars"},
                    {copy,"bin/emqx","bin/emqx"},
                    {copy,"bin/emqx_ctl","bin/emqx_ctl"},
                    {copy,"bin/install_upgrade.escript",
                        "bin/install_upgrade.escript"},
                    {copy,"bin/emqx","bin/emqx-{{release_version}}"},
                    {copy,"bin/emqx_ctl","bin/emqx_ctl-{{release_version}}"},
                    {copy,"bin/install_upgrade.escript",
                        "bin/install_upgrade.escript-{{release_version}}"},
                    {template,"bin/emqx.cmd","bin/emqx.cmd"},
                    {template,"bin/emqx_ctl.cmd","bin/emqx_ctl.cmd"},
                    {copy,"bin/nodetool","bin/nodetool"},
                    {copy,"bin/nodetool","bin/nodetool-{{release_version}}"},
                    {copy,"_build/default/lib/cuttlefish/cuttlefish",
                        "bin/cuttlefish"},
                    {copy,"_build/default/lib/cuttlefish/cuttlefish",
                        "bin/cuttlefish-{{release_version}}"},
                    {copy,"priv/emqx.schema","releases/{{release_version}}/"},
                    {mkdir,"etc/"},
                    {mkdir,"etc/plugins"},
                    {template,"etc/BUILT_ON",
                        "releases/{{release_version}}/BUILT_ON"},
                    {copy,"{{base_dir}}/lib/emqx/etc/certs","etc/"},
                    {template,"etc/acl.conf","etc/acl.conf"},
                    {template,"etc/emqx.conf","etc/emqx.conf"},
                    {template,"etc/ssl_dist.conf","etc/ssl_dist.conf"},
                    {template,"etc/acl.conf.paho","etc/plugins/acl.conf.paho"},
                    {template,"etc/emqx_edge.d/vm.args","etc/vm.args"},
                    {template,
                        "{{base_dir}}/lib/emqx_retainer/etc/emqx_retainer.conf",
                        "etc/plugins/emqx_retainer.conf"},
                    {template,
                        "{{base_dir}}/lib/emqx_management/etc/emqx_management.conf",
                        "etc/plugins/emqx_management.conf"},
                    {template,
                        "{{base_dir}}/lib/emqx_dashboard/etc/emqx_dashboard.conf",
                        "etc/plugins/emqx_dashboard.conf"},
                    {template,
                        "{{base_dir}}/lib/emqx_bridge_mqtt/etc/emqx_bridge_mqtt.conf",
                        "etc/plugins/emqx_bridge_mqtt.conf"},
                    {template,"{{base_dir}}/lib/emqx_sn/etc/emqx_sn.conf",
                        "etc/plugins/emqx_sn.conf"},
                    {template,
                        "{{base_dir}}/lib/emqx_coap/etc/emqx_coap.conf",
                        "etc/plugins/emqx_coap.conf"},
                    {template,
                        "{{base_dir}}/lib/emqx_stomp/etc/emqx_stomp.conf",
                        "etc/plugins/emqx_stomp.conf"},
                    {template,
                        "{{base_dir}}/lib/emqx_auth_http/etc/emqx_auth_http.conf",
                        "etc/plugins/emqx_auth_http.conf"},
                    {template,
                        "{{base_dir}}/lib/emqx_auth_mysql/etc/emqx_auth_mysql.conf",
                        "etc/plugins/emqx_auth_mysql.conf"},
                    {template,
                        "{{base_dir}}/lib/emqx_auth_jwt/etc/emqx_auth_jwt.conf",
                        "etc/plugins/emqx_auth_jwt.conf"},
                    {template,
                        "{{base_dir}}/lib/emqx_auth_mnesia/etc/emqx_auth_mnesia.conf",
                        "etc/plugins/emqx_auth_mnesia.conf"},
                    {template,
                        "{{base_dir}}/lib/emqx_web_hook/etc/emqx_web_hook.conf",
                        "etc/plugins/emqx_web_hook.conf"},
                    {template,
                        "{{base_dir}}/lib/emqx_recon/etc/emqx_recon.conf",
                        "etc/plugins/emqx_recon.conf"},
                    {template,
                        "{{base_dir}}/lib/emqx_rule_engine/etc/emqx_rule_engine.conf",
                        "etc/plugins/emqx_rule_engine.conf"},
                    {template,
                        "{{base_dir}}/lib/emqx_sasl/etc/emqx_sasl.conf",
                        "etc/plugins/emqx_sasl.conf"},
                    {template,
                        "{{base_dir}}/lib/emqx_telemetry/etc/emqx_telemetry.conf",
                        "etc/plugins/emqx_telemetry.conf"}]},
               {overlay_vars,
                   [{built_on_arch,"22.3.4.12-x86_64-apple-darwin19.6.0-64"},
                    "vars/vars-edge.config","vars/vars-pkg.config"]}]}]},
     {check,
         [{erl_opts,
              [debug_info,warnings_as_errors,{parse_transform,mod_vsn}]}]},
     {test,
         [{deps,
              [{bbmustache,"1.10.0"},
               {emqx_ct_helpers,
                   {git,"https://github.com/emqx/emqx-ct-helpers",
                       {tag,"1.3.4"}}},
               meck]},
          {erl_opts,
              [debug_info,
               {parse_transform,mod_vsn},
               {i,"apps"},
               {i,"apps/emqx_auth_http/include"},
               {i,"apps/emqx_auth_ldap/include"},
               {i,"apps/emqx_auth_mnesia/include"},
               {i,"apps/emqx_auth_mongo/include"},
               {i,"apps/emqx_auth_mysql/include"},
               {i,"apps/emqx_auth_pgsql/include"},
               {i,"apps/emqx_auth_redis/include"},
               {i,"apps/emqx_bridge_mqtt/include"},
               {i,"apps/emqx_coap/include"},
               {i,"apps/emqx_dashboard/include"},
               {i,"apps/emqx_exhook/include"},
               {i,"apps/emqx_exproto/include"},
               {i,"apps/emqx_lua_hook/include"},
               {i,"apps/emqx_lwm2m/include"},
               {i,"apps/emqx_management/include"},
               {i,"apps/emqx_prometheus/include"},
               {i,"apps/emqx_retainer/include"},
               {i,"apps/emqx_rule_engine/include"},
               {i,"apps/emqx_sasl/include"},
               {i,"apps/emqx_sn/include"},
               {i,"apps/emqx_stomp/include"},
               {i,"apps/emqx_web_hook/include"}]}]}]}.
